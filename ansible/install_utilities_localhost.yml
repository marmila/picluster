---

- name: Install helm and kubectl
  hosts: localhost
  gather_facts: false
  become: true
  vars:
    install_kubectl: true
    install_helm: true
    k8s_platform: linux
    k8s_arch: amd64
    kubectl_version: "1.33.4"
    # SHA512 checksum of the binary (see https://dl.k8s.io/release/v1.33.4/bin/linux/amd64/kubectl.sha512)
    kubectl_checksum_binary: "sha512:b2b9d3ab3731f0b2a740d04f442e2c85c154ecf6fa65146d7a4d08297e8f08bc075eeda9bb0aad3de0a2ea432eaa40d8f20177208ef5eb84b1dac192129a21c5"
    helm_version: 'v3.17.4'
  roles:
    - role: ricsanfre.k8s_cli

- name: Install other utilities
  hosts: localhost
  gather_facts: false
  become: true
  pre_tasks:
    - name: Include picluster variables
      ansible.builtin.include_vars: "vars/picluster.yml"
      tags: ["always"]
  roles:
    - role: fluxcd-cli
    - role: longhorn-cli
    - role: velero-cli
      vars:
        velero_arch: amd64
    - role: istio-cli
