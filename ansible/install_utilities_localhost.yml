---

- name: Install helm and kubectl
  hosts: localhost
  gather_facts: false
  become: true
  vars:
    install_kubectl: true
    install_helm: true
    k8s_platform: linux
    k8s_arch: amd64
    kubectl_version: "1.34.1"
    # SHA512 checksum of the binary (see https://dl.k8s.io/release/v1.34.1/bin/linux/amd64/kubectl.sha512)
    kubectl_checksum_binary: "sha512:bc4f4c98a2c4f7d872e5a8024dd0f47f73e1a5a6c8b833f265e7453c3c31f23555c3df1d921c5b3e8a0f6a1aae4954f0b5141db9c396c4206c947206eb34a398"
    helm_version: 'v3.17.4'
  roles:
    - role: ricsanfre.k8s_cli

- name: Install other utilities
  hosts: localhost
  gather_facts: false
  become: true
  pre_tasks:
    - name: Include picluster variables
      ansible.builtin.include_vars: "vars/picluster.yml"
      tags: ["always"]
  roles:
    - role: fluxcd-cli
    - role: longhorn-cli
    - role: velero-cli
      vars:
        velero_arch: amd64
    - role: istio-cli
