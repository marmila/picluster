# opentelemetry-collector helm values (ingress)
config:
  receivers:
    otlp:
      protocols:
        http:
          # Since this collector needs to receive data from the web, enable cors for all origins
          # `allowed_origins` can be refined for your deployment domain
          cors:
            allowed_origins:
              - "http://*.${CLUSTER_DOMAIN}"
              - "https://*.${CLUSTER_DOMAIN}"

# Enabling Ingress for OTEL Collector
ingress:
  enabled: true
  annotations:
    # Enable cert-manager to create automatically the SSL certificate and store in Secret
    cert-manager.io/cluster-issuer: ${TLS_ISSUER:=letsencrypt-issuer}
    cert-manager.io/common-name: otel-collector.${CLUSTER_DOMAIN}
  ingressClassName: nginx
  hosts:
    - host: otel-collector.${CLUSTER_DOMAIN}
      paths:
        - path: /
          pathType: Prefix
          port: 4318
  tls:
    - hosts:
        - otel-collector.${CLUSTER_DOMAIN}
      secretName: otel-collector-tls
