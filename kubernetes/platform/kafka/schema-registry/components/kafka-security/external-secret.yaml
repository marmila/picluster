---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: schema-registry-kafka-externalsecret
spec:
  secretStoreRef:
    name: vault-backend
    kind: ClusterSecretStore
  target:
    name: schema-registry-kafka-secret
  data:
  - secretKey: username
    remoteRef:
      key: kafka/schema-registry
      property: user
  - secretKey: password
    remoteRef:
      key: kafka/schema-registry
      property: password
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: schema-registry-jaas-externalsecret
spec:
  secretStoreRef:
    name: vault-backend
    kind: ClusterSecretStore
  target:
    name: schema-registry-jaas-config
    template:
      engineVersion: v2
      data:
        plain-jaas.conf: |
          org.apache.kafka.common.security.scram.ScramLoginModule required username={{ .username | toString }} password={{ .password | toString }};
  data:
  - secretKey: username
    remoteRef:
      key: kafka/schema-registry
      property: user
  - secretKey: password
    remoteRef:
      key: kafka/schema-registry
      property: password