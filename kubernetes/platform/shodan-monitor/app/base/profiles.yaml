# ApexForge – 22 profiles, capped max_results to save credits
#
# 22 profiles × 3 cycles/month ≈ 66 Shodan credits. max_results 1500–2500 per profile.
#
# Replaced solr/nexus/rabbitmq with firewall/VPN; RDP with cloud + dorks (MinIO, directory listing, Swagger).
# Fortinet/Cisco ASA/Palo Alto — ArcaneDoor, CVE-2025-20333, GlobalProtect brute force.

intelligence_profiles:
  # --- CRITICAL: DB LEAKS ---
  - name: unauthenticated_databases
    query: "product:mongodb port:27017 -authentication"
    severity: critical
    tags: [database, leak]
    enrich_with_internetdb: true
    max_results: 2000

  - name: unauthenticated_redis
    query: "product:redis port:6379 -authentication"
    severity: critical
    tags: [database, leak, cache]
    enrich_with_internetdb: true
    max_results: 2000

  - name: unauthenticated_postgresql
    query: "product:postgresql port:5432 -authentication"
    severity: critical
    tags: [database, leak]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_mysql
    query: "product:mysql port:3306"
    severity: critical
    tags: [database, mysql]
    enrich_with_internetdb: true
    max_results: 2500

  # --- CODE / ADMIN ---
  - name: exposed_gitlab
    query: "http.title:GitLab"
    severity: critical
    tags: [code, repository, git]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_phpmyadmin
    query: "http.title:phpMyAdmin"
    severity: high
    tags: [web, admin_interface]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_jenkins
    query: "product:jenkins port:8080"
    severity: high
    tags: [cicd, automation, web]
    enrich_with_internetdb: true
    max_results: 2000

  # --- CLOUD / OBJECT STORAGE ---
  - name: exposed_minio
    query: "MinIO"
    severity: critical
    tags: [cloud, storage, s3, object_storage]
    enrich_with_internetdb: true
    max_results: 2000

  # --- DORKS ---
  - name: directory_listing_index_of
    query: "http.html:\"Index of\""
    severity: high
    tags: [dork, directory_listing, data_leak]
    enrich_with_internetdb: true
    max_results: 2500

  - name: exposed_swagger_ui
    query: "http.title:Swagger"
    severity: high
    tags: [dork, api, documentation]
    enrich_with_internetdb: true
    max_results: 2000

  # --- MONITORING / DATA ---
  - name: exposed_grafana
    query: "http.title:Grafana"
    severity: high
    tags: [monitoring, dashboard]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_kibana
    query: "product:kibana port:5601"
    severity: high
    tags: [monitoring, elasticsearch]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_elasticsearch
    query: "product:elasticsearch port:9200"
    severity: high
    tags: [database, search, leak]
    enrich_with_internetdb: true
    max_results: 2000

  # --- CONTAINER / CLOUD ---
  - name: exposed_docker_registry
    query: "product:docker port:5000"
    severity: high
    tags: [cloud, container, registry]
    enrich_with_internetdb: true
    max_results: 1500

  # --- FIREWALL / VPN VENDORS (high-value targets in real campaigns) ---
  - name: exposed_fortinet_fortigate
    query: "FortiGate"
    severity: critical
    tags: [firewall, vpn, fortinet, vendor]
    enrich_with_internetdb: true
    max_results: 2500

  - name: exposed_cisco_asa_vpn
    query: "Cisco ASA SSL VPN"
    severity: critical
    tags: [firewall, vpn, cisco, vendor]
    enrich_with_internetdb: true
    max_results: 2500

  - name: exposed_paloalto_globalprotect
    query: "GlobalProtect"
    severity: critical
    tags: [firewall, vpn, paloalto, vendor]
    enrich_with_internetdb: true
    max_results: 2000

  # --- TIMESERIES ---
  - name: exposed_influxdb
    query: "product:influxdb port:8086"
    severity: high
    tags: [database, timeseries]
    enrich_with_internetdb: true
    max_results: 1500

  # --- CMS / WEB ---
  - name: exposed_wordpress_login
    query: "http.title:\"Log In\" http.html:\"wp-login\""
    severity: high
    tags: [cms, wordpress, admin_interface]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_drupal
    query: "http.html:\"Drupal\""
    severity: high
    tags: [cms, drupal, web]
    enrich_with_internetdb: true
    max_results: 1500

  - name: exposed_joomla
    query: "http.html:\"Joomla\""
    severity: high
    tags: [cms, joomla, web]
    enrich_with_internetdb: true
    max_results: 1500

  # --- ICS / OT ---
  - name: industrial_modbus
    query: "port:502 product:modbus"
    severity: critical
    tags: [ics, scada, modbus, ot]
    enrich_with_internetdb: false
    max_results: 1500
