# ApexForge – 20 profiles, capped max_results to save credits
#
# 20 profiles × 3 cycles/month ≈ 60 Shodan credits. max_results 1000–2500 per profile.

intelligence_profiles:
  # --- CRITICAL: DB LEAKS ---
  - name: unauthenticated_databases
    query: "product:mongodb port:27017 -authentication"
    severity: critical
    tags: [database, leak]
    enrich_with_internetdb: true
    max_results: 2000

  - name: unauthenticated_redis
    query: "product:redis port:6379 -authentication"
    severity: critical
    tags: [database, leak, cache]
    enrich_with_internetdb: true
    max_results: 2000

  - name: unauthenticated_postgresql
    query: "product:postgresql port:5432 -authentication"
    severity: critical
    tags: [database, leak]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_mysql
    query: "product:mysql port:3306"
    severity: critical
    tags: [database, mysql]
    enrich_with_internetdb: true
    max_results: 2500

  # --- CODE / ADMIN ---
  - name: exposed_gitlab
    query: "http.title:GitLab"
    severity: critical
    tags: [code, repository, git]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_phpmyadmin
    query: "http.title:phpMyAdmin"
    severity: high
    tags: [web, admin_interface]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_jenkins
    query: "product:jenkins port:8080"
    severity: high
    tags: [cicd, automation, web]
    enrich_with_internetdb: true
    max_results: 2000

  # --- REMOTE ACCESS (capped) ---
  - name: exposed_rdp
    query: "product:rdp port:3389"
    severity: high
    tags: [remote_access, windows]
    enrich_with_internetdb: true
    max_results: 2000

  # --- MONITORING / DATA ---
  - name: exposed_grafana
    query: "http.title:Grafana"
    severity: high
    tags: [monitoring, dashboard]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_kibana
    query: "product:kibana port:5601"
    severity: high
    tags: [monitoring, elasticsearch]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_elasticsearch
    query: "product:elasticsearch port:9200"
    severity: high
    tags: [database, search, leak]
    enrich_with_internetdb: true
    max_results: 2000

  # --- CONTAINER / CLOUD ---
  - name: exposed_docker_registry
    query: "product:docker port:5000"
    severity: high
    tags: [cloud, container, registry]
    enrich_with_internetdb: true
    max_results: 1500

  # --- SEARCH / MESSAGING / TIMESERIES ---
  - name: exposed_solr
    query: "product:solr port:8983"
    severity: high
    tags: [search, apache, data_leak]
    enrich_with_internetdb: true
    max_results: 1500

  - name: exposed_rabbitmq
    query: "product:rabbitmq port:5672"
    severity: high
    tags: [messaging, queue, amqp]
    enrich_with_internetdb: true
    max_results: 1500

  - name: exposed_influxdb
    query: "product:influxdb port:8086"
    severity: high
    tags: [database, timeseries]
    enrich_with_internetdb: true
    max_results: 1500

  # --- CMS / WEB ---
  - name: exposed_wordpress_login
    query: "http.title:\"Log In\" http.html:\"wp-login\""
    severity: high
    tags: [cms, wordpress, admin_interface]
    enrich_with_internetdb: true
    max_results: 2000

  - name: exposed_drupal
    query: "http.html:\"Drupal\""
    severity: high
    tags: [cms, drupal, web]
    enrich_with_internetdb: true
    max_results: 1500

  - name: exposed_joomla
    query: "http.html:\"Joomla\""
    severity: high
    tags: [cms, joomla, web]
    enrich_with_internetdb: true
    max_results: 1500

  # --- IoT / DEVOPS / ICS ---
  - name: exposed_nexus
    query: "http.title:Nexus port:8081"
    severity: high
    tags: [devops, artifact, repository]
    enrich_with_internetdb: true
    max_results: 1500

  - name: industrial_modbus
    query: "port:502 product:modbus"
    severity: critical
    tags: [ics, scada, modbus, ot]
    enrich_with_internetdb: false
    max_results: 1500
